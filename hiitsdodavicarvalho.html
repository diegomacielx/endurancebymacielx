<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Periodiza√ß√£o HIIT de 12 Semanas - Davi Carvalho</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #000000;
            touch-action: manipulation; /* Impede zoom com duplo toque */
        }
        .main-title {
            color: #EF4444; /* Vermelho Vibrante */
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        .card {
            background-color: #1F2937;
            border-left: 4px solid #EF4444; /* Vermelho Vibrante */
        }
        .icon {
            color: #EF4444; /* Vermelho Vibrante */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
        .nav-button {
            background-color: #EF4444; /* Vermelho Vibrante */
            color: white;
            padding: 12px 24px;
            border-radius: 9999px;
            font-weight: 700;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: inline-block;
            margin-top: 2rem;
        }
        .nav-button:hover {
            background-color: #DC2626; /* Vermelho mais escuro */
        }
        .timer-page {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .timer-display {
            font-size: 5rem;
            font-weight: 900;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.7);
            margin-bottom: 1rem;
        }
        .phase-display {
            font-size: 2.5rem;
            font-weight: 700;
            color: #D1D5DB;
            margin-bottom: 0.5rem;
        }
        .set-display {
            font-size: 1.5rem;
            color: #9CA3AF;
            margin-bottom: 2rem;
        }
        .timer-controls button {
            background-color: #1F2937;
            color: #EF4444; /* Vermelho Vibrante */
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 700;
            margin: 0.5rem;
            transition: background-color 0.3s ease, color 0.3s ease;
            border: 2px solid #EF4444; /* Vermelho Vibrante */
        }
        .timer-controls button:hover:not(:disabled) {
            background-color: #EF4444; /* Vermelho Vibrante */
            color: white;
        }
        .timer-controls button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        .config-section {
            background-color: #1F2937;
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 2rem;
            width: 100%;
            max-width: 700px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
            border: 1px solid #EF4444; /* Vermelho Vibrante */
        }
        .phase-item {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-end;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background-color: #2D3748;
            border-radius: 8px;
            border: 1px solid #4A5568;
        }
        .phase-item > div {
            display: flex;
            flex-direction: column;
        }
        .phase-item input[type="text"],
        .phase-item input[type="number"],
        .config-section select {
            background-color: #4A5568;
            color: white;
            border: 1px solid #6B7280;
            padding: 0.5rem;
            border-radius: 4px;
            flex-grow: 1;
        }
        .phase-item button {
            background-color: #EF4444;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            font-weight: 600;
            transition: background-color 0.3s ease;
        }
        .phase-item button:hover {
            background-color: #DC2626;
        }
        .add-phase-btn {
            background-color: #4CAF50;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 700;
            margin-top: 1rem;
            transition: background-color 0.3s ease;
        }
        .add-phase-btn:hover {
            background-color: #45a049;
        }
        .save-load-buttons button {
            background-color: #EF4444;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 700;
            margin: 0.5rem;
            transition: background-color 0.3s ease;
        }
        .save-load-buttons button:hover {
            background-color: #DC2626;
        }
    </style>
</head>
<body class="text-gray-200">

    <!-- P√°gina do Infogr√°fico Principal -->
    <div id="main-infographic-page" class="container mx-auto p-4 md:p-8">

        <header class="mb-12">
            <div class="w-full">
                <div class="mb-12 text-center">
                    <img id="userLogo" src="https://i.imgur.com/rLLYQ3Z.png" alt="Sua Logo" class="inline-block rounded-lg shadow-md" style="max-width: 150px; height: auto;">
                    <p class="text-xl font-bold text-white mt-2">Consultoria Esportiva Premium</p>
                </div>
                <div class="text-left mb-10">
                    <p class="text-md md:text-lg text-gray-400">Aluno: Davi Carvalho</p>
                    <p class="text-md md:text-lg text-gray-400">Objetivo: melhoria da capacidade cardiovascular</p>
                </div>
            </div>
            <div class="text-center mt-8">
                <h1 class="text-4xl md:text-6xl font-black main-title mb-2">SUA JORNADA HIIT DE 12 SEMANAS</h1>
                <p class="text-lg md:text-xl text-gray-300">Feito pra voc√™ superar seus limites na corrida de rua.</p>
            </div>
        </header>

        <section id="understanding" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-white">Entendendo seu treino</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <div class="icon text-4xl mb-3">üî•</div>
                    <h3 class="font-bold text-xl mb-2 text-white">Est√≠mulo (Tiro)</h3>
                    <p class="text-gray-400">Aumente a velocidade. A meta √© atingir um esfor√ßo muito forte (PSE 8 a 10) e uma frequ√™ncia card√≠aca entre <span class="font-bold text-red-400">169-189 BPM</span>.</p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <div class="icon text-4xl mb-3">üíß</div>
                    <h3 class="font-bold text-xl mb-2 text-white">Recupera√ß√£o Ativa</h3>
                    <p class="text-gray-400">Reduza a velocidade para uma caminhada (PSE 3-4) e observe seus batimentos card√≠acos diminu√≠rem para a zona moderada (<span class="font-bold text-red-400">119-149 BPM</span>).</p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <div class="icon text-4xl mb-3">üå°Ô∏è</div>
                    <h3 class="font-bold text-xl mb-2 text-white">Aquecimento</h3>
                    <p class="text-gray-400">5 minutos de caminhada moderada para preparar o corpo, elevando gradualmente os batimentos para a zona de treino.</p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <div class="icon text-4xl mb-3">üßò</div>
                    <h3 class="font-bold text-xl mb-2 text-white">Desaquecimento</h3>
                    <p class="text-gray-400">2 minutos de caminhada leve para normalizar os batimentos card√≠acos e relaxar a musculatura ap√≥s o esfor√ßo.</p>
                </div>
            </div>
        </section>

        <section id="progression-charts" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-white">Gr√°ficos da Sua Progress√£o</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="card p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-4 text-center text-white">Est√≠mulo vs. Recupera√ß√£o</h3>
                    <div class="chart-container">
                        <canvas id="stimulusRecoveryChart"></canvas>
                    </div>
                     <p class="text-center text-gray-400 mt-4">O tempo de est√≠mulo aumenta a cada m√™s, mantendo a recupera√ß√£o constante para aumentar o desafio.</p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-4 text-center text-white">Volume Total de Est√≠mulo por Treino</h3>
                    <div class="chart-container">
                        <canvas id="totalWorkChart"></canvas>
                    </div>
                     <p class="text-center text-gray-400 mt-4">O tempo total que voc√™ passa em alta intensidade aumentar√° a cada m√™s.</p>
                </div>
            </div>
        </section>

        <section id="monthly-breakdown" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-white">Detalhamento Mensal do HIIT</h2>
             <p class="text-center max-w-3xl mx-auto mb-10 text-gray-300">Realize este treino <span class="font-bold text-red-400">3 vezes por semana</span> em dias alternados (ex: Seg, Qua, Sex). Dura√ß√£o total de <span class="font-bold text-red-400">20 minutos</span>.</p>
            <div class="space-y-8">
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <h3 class="font-bold text-xl mb-2 text-white">M√™s 1 (Semanas 1-4): Adapta√ß√£o</h3>
                    <p class="text-gray-400">
                        <strong>Estrutura:</strong> 8 ciclos de <span class="font-bold">20s Est√≠mulo</span> / <span class="font-bold">60s Recupera√ß√£o</span>.
                        <br>
                        Foco em aprender a controlar o ritmo e a respira√ß√£o.
                    </p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <h3 class="font-bold text-xl mb-2 text-white">M√™s 2 (Semanas 5-8): Intensifica√ß√£o</h3>
                    <p class="text-gray-400">
                        <strong>Estrutura:</strong> 8 ciclos de <span class="font-bold">25s Est√≠mulo</span> / <span class="font-bold">60s Recupera√ß√£o</span>.
                        <br>
                        Aumentando o tempo de esfor√ßo para desafiar sua resist√™ncia.
                    </p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg text-center">
                    <h3 class="font-bold text-xl mb-2 text-white">M√™s 3 (Semanas 9-12): Performance</h3>
                    <p class="text-gray-400">
                        <strong>Estrutura:</strong> 8 ciclos de <span class="font-bold">30s Est√≠mulo</span> / <span class="font-bold">60s Recupera√ß√£o</span>.
                        <br>
                        Consolidando sua capacidade de realizar est√≠mulos mais longos.
                    </p>
                </div>
            </div>
        </section>

        <section id="heart-rate-zones" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-white">Suas Zonas de Frequ√™ncia Card√≠aca</h2>
            <p class="text-center max-w-3xl mx-auto mb-10 text-gray-300">Baseado na sua idade, sua frequ√™ncia card√≠aca m√°xima (FCM) estimada √© de <span class="font-bold text-red-400">202 BPM</span>. Use as zonas abaixo como guia, em conjunto com a Escala de Esfor√ßo (PSE).</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="card p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-2 text-white">Zona Moderada (60-75% FCM)</h3>
                    <p class="text-gray-400"><strong>Alvo: <span class="font-bold text-red-400">119 - 149 BPM</span></strong></p>
                    <p class="text-gray-400 mt-2">Ideal para a recupera√ß√£o ativa entre os tiros. Melhora a resist√™ncia e a capacidade do corpo de usar gordura como combust√≠vel. O esfor√ßo √© confort√°vel e sustent√°vel.</p>
                </div>
                <div class="card p-6 rounded-lg shadow-lg">
                    <h3 class="font-bold text-xl mb-2 text-white">Zona de Alta Intensidade (85-95% FCM)</h3>
                    <p class="text-gray-400"><strong>Alvo: <span class="font-bold text-red-400">169 - 189 BPM</span></strong></p>
                    <p class="text-gray-400 mt-2">O objetivo durante os tiros dos treinos HIIT. Melhora o VO‚ÇÇ m√°x. e a capacidade anaer√≥bica. O esfor√ßo √© muito desafiador e s√≥ pode ser mantido por curtos per√≠odos.</p>
                </div>
            </div>
        </section>

        <section id="rpe-scale" class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-white">Escala de Percep√ß√£o Subjetiva de Esfor√ßo (PSE)</h2>
            <p class="text-center max-w-3xl mx-auto mb-10 text-gray-300">Esta escala (Borg CR10) ajuda voc√™ a monitorar a intensidade do seu treino, baseando-se em como voc√™ se sente. Use-a para guiar seus esfor√ßos.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üü¢ 0 ‚Äì Nada de esfor√ßo</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Repouso absoluto. Voc√™ est√° completamente relaxado, sem nenhuma atividade f√≠sica.<br>Exemplo na corrida: N√£o aplic√°vel (est√° em repouso).</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üîµ 0.5 ‚Äì Muito, muito leve</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Praticamente nenhum esfor√ßo. A sensa√ß√£o √© quase impercept√≠vel, como se voc√™ estivesse parado.<br>Exemplo na corrida: Caminhada extremamente lenta e tranquila.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üîµ 1 ‚Äì Muito leve</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Esfor√ßo m√≠nimo, quase despreocupado. Voc√™ pode conversar e cantar com facilidade.<br>Exemplo na corrida: Caminhada suave, aquecimento bem leve.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üåø 2 ‚Äì Leve</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Atividade tranquila e confort√°vel. Respira√ß√£o aumenta levemente, mas ainda h√° total controle. √â poss√≠vel falar sem esfor√ßo.<br>Exemplo na corrida: Trote bem leve ou corrida de recupera√ß√£o.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üü° 3 ‚Äì Moderado</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Um esfor√ßo constante, mas sustent√°vel por longos per√≠odos. A respira√ß√£o fica mais profunda, mas voc√™ ainda consegue manter uma conversa sem dificuldade.<br>Exemplo na corrida: Corrida em ritmo conversacional, treino leve.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üü° 4 ‚Äì Um pouco forte</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: O esfor√ßo come√ßa a ser not√°vel. A respira√ß√£o acelera e falar passa a exigir um pouco de aten√ß√£o.<br>Exemplo na corrida: Ritmo constante, um pouco mais r√°pido do que o normal.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">‚ö†Ô∏è 5 ‚Äì Forte</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Desafiador, mas ainda sustent√°vel. Falar torna-se dif√≠cil; voc√™ s√≥ consegue dizer algumas palavras entre as respira√ß√µes.<br>Exemplo na corrida: Ritmo pr√≥ximo ao de maratona ou meia maratona (para corredores experientes).</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">‚ö†Ô∏è 6 ‚Äì Forte (quase muito forte)</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Esfor√ßo intenso. Falar √© limitado a uma ou duas palavras por vez. A respira√ß√£o est√° pesada e r√°pida.<br>Exemplo na corrida: Ritmo de 10 km ou trabalho no limiar anaer√≥bico.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üî¥ 7 ‚Äì Muito forte</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Extremamente desafiador. Voc√™ est√° pr√≥ximo ao seu limite de fala e consegue apenas emitir sons ou palavras curtas.<br>Exemplo na corrida: Treinos intervalados intensos ou ritmo de 5 km.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üî• 8 ‚Äì Muito, muito forte</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Intensidade elevada, quase insuport√°vel por muito tempo. A respira√ß√£o √© muito ofegante e o corpo pede pausa.<br>Exemplo na corrida: Final de um treino intenso ou esfor√ßo de prova curta.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">üí• 9 ‚Äì Quase m√°ximo</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Voc√™ est√° praticamente no seu limite f√≠sico. Consegue manter esse esfor√ßo por poucos minutos no m√°ximo.<br>Exemplo na corrida: Sprint final em uma prova, esfor√ßo de 400 metros.</p></div>
                <div class="card p-4 rounded-lg shadow-lg"><h3 class="font-bold text-lg mb-2 text-white">‚ö° 10 ‚Äì M√°ximo</h3><p class="text-gray-400 text-sm">Sensa√ß√£o: Esfor√ßo total. Seu corpo est√° no seu limite absoluto. √â um esfor√ßo explosivo e insustent√°vel por mais do que alguns segundos.<br>Exemplo na corrida: Sprint total, como em uma prova de 100 metros.</p></div>
            </div>
        </section>

        <div class="text-center">
            <button id="goToTimerPageBtn" class="nav-button">Abrir Temporizador de Treino</button>
        </div>

        <footer class="text-center mt-12 pt-8 border-t border-gray-700">
            <p class="text-gray-400">S√≥ alegria!</p>
        </footer>

    </div>

    <!-- P√°gina do Temporizador de Treino -->
    <div id="timer-app-page" class="timer-page hidden">
        <h1 class="text-4xl md:text-5xl font-black main-title mb-8 text-center">TEMPORIZADOR DE TREINO</h1>

        <div class="config-section mb-8">
            <h2 class="text-2xl font-bold text-white mb-4 text-center">Selecionar Treino do Plano</h2>
            <div class="flex flex-col md:flex-row gap-4 mb-4">
                <div class="flex-1">
                    <label for="monthSelect" class="block text-gray-300 text-lg mb-2">M√™s:</label>
                    <select id="monthSelect" class="w-full"></select>
                </div>
            </div>
            <button id="loadSelectedWorkoutBtn" class="nav-button w-full">Carregar Treino Selecionado</button>
        </div>

        <div class="text-center mb-8">
            <p class="phase-display" id="currentPhaseName">Pronto para Iniciar</p>
            <p class="timer-display text-gray-200" id="timeLeftDisplay">00:00</p>
            <p class="text-gray-400 text-lg mt-2" id="phaseInstructions"></p>
            <p class="set-display" id="currentSetDisplay">S√©rie: 0/0</p>
        </div>

        <div class="timer-controls flex justify-center flex-wrap">
            <button id="startBtn">Iniciar</button>
            <button id="pauseBtn" disabled>Pausar</button>
            <button id="resetBtn">Reiniciar</button>
            <button id="skipBtn" disabled>Pular Fase</button>
            <button id="backToInfographicBtn">Voltar</button>
        </div>
    </div>

    <script>
        // --- Fun√ß√µes Auxiliares ---
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            return `${String(minutes).padStart(2, '0')}:${String(remainingSeconds).padStart(2, '0')}`;
        }

        // --- Vari√°veis Globais do Temporizador ---
        let workoutConfig = [];
        let currentPhaseIndex = 0;
        let timeLeft = 0;
        let timerIntervalId = null;
        let isPaused = false;
        let wakeLock = null; // Vari√°vel para o Wake Lock

        // --- Refer√™ncias de Elementos HTML ---
        const mainInfographicPage = document.getElementById('main-infographic-page');
        const timerAppPage = document.getElementById('timer-app-page');
        const goToTimerPageBtn = document.getElementById('goToTimerPageBtn');
        const backToInfographicBtn = document.getElementById('backToInfographicBtn');
        const currentPhaseName = document.getElementById('currentPhaseName');
        const timeLeftDisplay = document.getElementById('timeLeftDisplay');
        const phaseInstructions = document.getElementById('phaseInstructions');
        const currentSetDisplay = document.getElementById('currentSetDisplay');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const skipBtn = document.getElementById('skipBtn');
        const monthSelect = document.getElementById('monthSelect');
        const loadSelectedWorkoutBtn = document.getElementById('loadSelectedWorkoutBtn');

        // --- Defini√ß√£o do Plano de Treino do Davi (12 Semanas) ---
        function generateHIIT(stimulus, recovery, rounds, warmup, cooldown) {
            const workout = [{ name: 'Aquecimento', duration: warmup * 60, intensity: 'Baixa', description: 'Caminhada para aquecer.' }];
            for (let i = 0; i < rounds; i++) {
                workout.push({ name: `Tiro ${i + 1}/${rounds}`, duration: stimulus, intensity: 'Alta', description: 'Corra! PSE 8-9. BPM: 172-202' });
                workout.push({ name: `Recupera√ß√£o ${i + 1}/${rounds}`, duration: recovery, intensity: 'Baixa', description: 'Caminhe para recuperar. PSE 3-4.' });
            }
            workout.push({ name: 'Desaquecimento', duration: cooldown * 60, intensity: 'Baixa', description: 'Caminhada leve.' });
            return workout;
        }

        const fullTrainingPlan = {
            'M√™s 1': generateHIIT(20, 60, 8, 5, 2),
            'M√™s 2': generateHIIT(25, 60, 8, 5, 2),
            'M√™s 3': generateHIIT(30, 60, 8, 5, 2)
        };

        // --- Fun√ß√µes de Navega√ß√£o ---
        goToTimerPageBtn.addEventListener('click', () => {
            mainInfographicPage.classList.add('hidden');
            timerAppPage.classList.remove('hidden');
            timerAppPage.style.display = 'flex';
            populateSelectors();
            loadSelectedWorkout(); // Load default workout on open
        });

        backToInfographicBtn.addEventListener('click', () => {
            pauseTimer();
            mainInfographicPage.classList.remove('hidden');
            timerAppPage.classList.add('hidden');
            timerAppPage.style.display = 'none';
        });

        // --- Fun√ß√µes de Configura√ß√£o do Treino ---
        function populateSelectors() {
            monthSelect.innerHTML = '';
            Object.keys(fullTrainingPlan).forEach(month => {
                const option = document.createElement('option');
                option.value = month;
                option.textContent = month;
                monthSelect.appendChild(option);
            });
        }

        function loadSelectedWorkout() {
             const selectedMonth = monthSelect.value;
            if (fullTrainingPlan[selectedMonth]) {
                workoutConfig = fullTrainingPlan[selectedMonth];
                resetTimer();
            } else {
                alert('Treino n√£o encontrado para a sele√ß√£o.');
            }
        }
        
        loadSelectedWorkoutBtn.addEventListener('click', () => {
            loadSelectedWorkout();
            alert(`Treino do ${monthSelect.value} carregado!`);
        });

        // --- Wake Lock (Manter a tela acesa) ---
        const requestWakeLock = async () => {
            if ('wakeLock' in navigator) {
                try {
                    wakeLock = await navigator.wakeLock.request('screen');
                    console.log('Wake Lock ativado!');
                } catch (err) {
                    console.error(`${err.name}, ${err.message}`);
                }
            }
        };

        const releaseWakeLock = async () => {
            if (wakeLock !== null) {
                await wakeLock.release();
                wakeLock = null;
                console.log('Wake Lock liberado.');
            }
        };

        // --- Fun√ß√µes do Temporizador ---
        function applyTimerColor(intensity) {
            timeLeftDisplay.classList.remove('text-green-500', 'text-yellow-500', 'text-red-500', 'text-gray-200');
            currentPhaseName.classList.remove('text-green-500', 'text-yellow-500', 'text-red-500');

            switch (intensity) {
                case 'Baixa': timeLeftDisplay.classList.add('text-green-500'); currentPhaseName.classList.add('text-green-500'); break;
                case 'Moderada': timeLeftDisplay.classList.add('text-yellow-500'); currentPhaseName.classList.add('text-yellow-500'); break;
                case 'Alta': timeLeftDisplay.classList.add('text-red-500'); currentPhaseName.classList.add('text-red-500'); break;
                default: timeLeftDisplay.classList.add('text-gray-200'); currentPhaseName.classList.add('text-gray-200'); break;
            }
        }

        function updateDisplay() {
            const currentPhase = workoutConfig[currentPhaseIndex];
            
            currentSetDisplay.textContent = `Fase: ${currentPhaseIndex + 1}/${workoutConfig.length}`;
            timeLeftDisplay.textContent = formatTime(timeLeft);

            if (currentPhase) {
                currentPhaseName.textContent = currentPhase.name;
                phaseInstructions.textContent = currentPhase.description || '';
                applyTimerColor(currentPhase.intensity);
            } else {
                currentPhaseName.textContent = "Nenhuma Fase";
                phaseInstructions.textContent = "";
                applyTimerColor(null);
            }
        }

        function nextPhase() {
            currentPhaseIndex++;
            if (currentPhaseIndex >= workoutConfig.length) {
                clearInterval(timerIntervalId);
                timerIntervalId = null;
                currentPhaseName.textContent = "Treino Conclu√≠do!";
                timeLeftDisplay.textContent = "00:00";
                currentSetDisplay.textContent = `Parab√©ns!`;
                startBtn.disabled = true;
                pauseBtn.disabled = true;
                skipBtn.disabled = true;
                applyTimerColor(null);
                releaseWakeLock(); // Liberar a tela ao final
                return;
            }
            timeLeft = workoutConfig[currentPhaseIndex].duration;
            updateDisplay();
        }

        function startTimer() {
            if (timerIntervalId || workoutConfig.length === 0) return;
            
            requestWakeLock(); // Ativar bloqueio de tela

            startBtn.disabled = true;
            pauseBtn.disabled = false;
            skipBtn.disabled = false;
            isPaused = false;

            if (timeLeft === 0) {
                 timeLeft = workoutConfig.length > 0 ? workoutConfig[0].duration : 0;
            }
            
            updateDisplay();

            timerIntervalId = setInterval(() => {
                if (timeLeft > 0) {
                    timeLeft--;
                    updateDisplay();
                }

                if (timeLeft <= 0) {
                    nextPhase();
                }
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(timerIntervalId);
            timerIntervalId = null;
            isPaused = true;
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            releaseWakeLock(); // Liberar a tela ao pausar
        }

        function resetTimer() {
            clearInterval(timerIntervalId);
            timerIntervalId = null;
            currentPhaseIndex = 0;
            timeLeft = workoutConfig.length > 0 ? workoutConfig[0].duration : 0;
            isPaused = false;
            updateDisplay();
            startBtn.disabled = false;
            pauseBtn.disabled = true;
            skipBtn.disabled = true;
            applyTimerColor(null);
            releaseWakeLock(); // Liberar a tela ao reiniciar
        }
        
        function skipPhase() {
            if (!timerIntervalId) return;
            nextPhase();
        }

        // --- Event Listeners ---
        startBtn.addEventListener('click', startTimer);
        pauseBtn.addEventListener('click', pauseTimer);
        resetBtn.addEventListener('click', resetTimer);
        skipBtn.addEventListener('click', skipPhase);
        
        // Re-adquirir o wake lock se a aba ficar vis√≠vel novamente
        document.addEventListener('visibilitychange', () => {
            if (document.visibilityState === 'visible' && timerIntervalId !== null) {
                requestWakeLock();
            }
        });

        // --- L√≥gica dos Gr√°ficos ---
        const commonChartOptions = {
            maintainAspectRatio: false,
            responsive: true,
            plugins: { legend: { labels: { color: '#D1D5DB' } } },
            scales: {
                y: { beginAtZero: true, ticks: { color: '#9CA3AF' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
                x: { ticks: { color: '#9CA3AF' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
            }
        };

        const stimulusRecoveryData = {
            labels: ['M√™s 1', 'M√™s 2', 'M√™s 3'],
            datasets: [
                {
                    label: 'Est√≠mulo (s)',
                    data: [20, 25, 30],
                    backgroundColor: 'rgba(239, 68, 68, 0.7)',
                    borderColor: '#EF4444',
                    borderWidth: 1
                },
                {
                    label: 'Recupera√ß√£o (s)',
                    data: [60, 60, 60],
                    backgroundColor: 'rgba(59, 130, 246, 0.7)',
                    borderColor: '#3B82F6',
                    borderWidth: 1
                }
            ]
        };

        const totalWorkData = {
            labels: ['M√™s 1', 'M√™s 2', 'M√™s 3'],
            datasets: [{
                label: 'Tempo Total de Est√≠mulo (s)',
                data: [20 * 8, 25 * 8, 30 * 8],
                borderColor: '#EF4444',
                backgroundColor: 'rgba(239, 68, 68, 0.2)',
                fill: true,
                tension: 0.3
            }]
        };

        // --- Inicializa√ß√£o ---
        document.addEventListener('DOMContentLoaded', () => {
            new Chart(document.getElementById('stimulusRecoveryChart'), {
                type: 'bar',
                data: stimulusRecoveryData,
                options: { ...commonChartOptions, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, title: { display: true, text: 'Segundos', color: '#9CA3AF' } } } }
            });
            
            new Chart(document.getElementById('totalWorkChart'), {
                type: 'line',
                data: totalWorkData,
                options: { ...commonChartOptions, scales: { ...commonChartOptions.scales, y: { ...commonChartOptions.scales.y, title: { display: true, text: 'Segundos', color: '#9CA3AF' } } } }
            });

            populateSelectors();
            loadSelectedWorkout();
        });
    </script>
</body>
</html>

